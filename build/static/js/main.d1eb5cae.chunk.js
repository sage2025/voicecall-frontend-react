(this["webpackJsonpvoice-call-app-client"]=this["webpackJsonpvoice-call-app-client"]||[]).push([[0],{63:function(n,e){function t(n){var e=new Error("Cannot find module '"+n+"'");throw e.code="MODULE_NOT_FOUND",e}t.keys=function(){return[]},t.resolve=t,n.exports=t,t.id=63},95:function(n,e,t){"use strict";t.r(e);var r,i,o,c,a,s,u,d,l,p,f,h,b,m,x,j,g,v,w,O,y,k,C,B,R,z,F,S,M,P,T=t(1),E=t.n(T),A=t(45),I=t.n(A),N=t(6),D=t(8),U=t(3),J=t(5),L=t.n(J),Y=t(4),_=t(22),q=t(46),Q="#3C91E6",V="#342E37",W="#FAFFFD",G="#0A0A0A",H="#1F1F1F",K="#FF3131",X=t(49),Z=t.n(X),$=window.location.port,nn=new Z.a((Math.random().toString(36)+"0000000000000000000").substr(2,16),{host:window.location.hostname,port:$,path:"/rtc",debug:1}),en=t(50),tn="".concat(window.location.hostname).concat(""),rn=Object(en.io)(tn),on=t(13),cn=t.n(on),an=function(){return new Promise(function(){var n=Object(N.a)(L.a.mark((function n(e,t){var r,i;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,fetch("/api/rooms");case 3:return r=n.sent,n.next=6,r.json();case 6:i=n.sent,e(i),n.next=14;break;case 10:n.prev=10,n.t0=n.catch(0),t(n.t0),console.log(n.t0);case 14:case"end":return n.stop()}}),n,null,[[0,10]])})));return function(e,t){return n.apply(this,arguments)}}())},sn=function(){return new Promise(function(){var n=Object(N.a)(L.a.mark((function n(e,t){var r,i,o;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,an();case 2:if(r=n.sent,i=r.connections,!(o=i.find((function(n){return n.peers.find((function(n){return(null===n||void 0===n?void 0:n.id)===nn.id}))})))){n.next=8;break}return e(o),n.abrupt("return");case 8:e(void 0);case 9:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}())},un=function(){return cn.a.fire({title:"What's your name ?",text:"Pss... You need to fill name input with your name!",icon:"error"})},dn=function(){return cn.a.fire({title:"Room id length is too small \ud83d\ude12",text:"Ah shit, here we go again.",icon:"error"})},ln=function(n){return cn.a.fire({title:"Room: ".concat(n," is not existing \ud83d\ude22"),text:"Maybe it's typo.",icon:"error"})},pn=function(){var n=Object(T.useState)(),e=Object(D.a)(n,2),t=e[0],r=e[1],i=Object(T.useState)(),o=Object(D.a)(i,2),c=o[0],a=o[1];Object(T.useEffect)((function(){rn.on("onJoinToRoom",function(){var n=Object(N.a)(L.a.mark((function n(e){var t;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s(e),n.next=3,sn();case 3:t=n.sent,a(t);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()),rn.on("leftFromRoom",function(){var n=Object(N.a)(L.a.mark((function n(e){var t;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e.id,e.peer,n.next=3,sn();case 3:t=n.sent,a(t);case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}),[]),Object(T.useEffect)((function(){t&&nn.on("call",function(){var n=Object(N.a)(L.a.mark((function n(e){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.answer(t),e.on("stream",u),e.on("error",(function(){return console.error("peer error")}));case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}),[t]);var s=function(){var n=Object(N.a)(L.a.mark((function n(e){var t;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:t=n.sent,r(t),e.peers.forEach((function(n){if((null===n||void 0===n?void 0:n.id)!==nn.id){var e=nn.call(null===n||void 0===n?void 0:n.id,t);null===e||void 0===e||e.on("stream",u),e.on("close",(function(){return console.log("".concat(null===n||void 0===n?void 0:n.id," closed call"))})),e.on("error",(function(){return console.error("peer error")}))}}));case 5:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}(),u=function(n){var e=new AudioContext;e.createMediaStreamSource(n).connect(e.destination)},d=function(){var n=Object(N.a)(L.a.mark((function n(e,t){var r,i;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t){n.next=3;break}return un(),n.abrupt("return");case 3:if(!(e.length<5)){n.next=6;break}return dn(),n.abrupt("return");case 6:return n.next=8,an();case 8:if(r=n.sent,(i=r.connections).find((function(n){return n.room===e}))){n.next=13;break}return ln(e),n.abrupt("return");case 13:if(!i.find((function(n){return n.peers.find((function(n){return(null===n||void 0===n?void 0:n.name)===t}))}))){n.next=16;break}return cn.a.fire({title:"Ahhh! Your name is already taken in this room \ud83d\ude2b",text:"Change it and try again.",icon:"error"}),n.abrupt("return");case 16:rn.emit("joinToRoom",{id:e,peer:nn.id,name:t,color:"#".concat(Math.floor(16777215*Math.random()).toString(16))});case 17:case"end":return n.stop()}}),n)})));return function(e,t){return n.apply(this,arguments)}}(),l=function(){var n=Object(N.a)(L.a.mark((function n(){var e;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,sn();case 2:(e=n.sent)&&rn.emit("leaveFromRoom",{id:e.room,peer:nn.id});case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return{connectToRoom:d,leaveFromRoom:l,createRoom:function(n,e){return new Promise(function(){var t=Object(N.a)(L.a.mark((function t(r,i){var o,c;return L.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,an();case 2:if(o=t.sent,c=o.connections,e){t.next=8;break}return un(),i(),t.abrupt("return");case 8:if(n){t.next=12;break}return cn.a.fire({title:"Ooops! You forgot to set room id!",text:"Mamma Mia! \ud83c\udf55 \ud83c\udf5d",icon:"error"}),i(),t.abrupt("return");case 12:if(!(n.length<5)){t.next=16;break}return dn(),i(),t.abrupt("return");case 16:if(!c.find((function(e){return e.room===n}))){t.next=20;break}return cn.a.fire({title:"Room is already exist! \ud83d\ude2b",text:"Oh! No!",icon:"error"}),i(),t.abrupt("return");case 20:rn.emit("createRoom",{id:n,peer:nn.id}),r({id:n,peer:nn.id});case 22:case"end":return t.stop()}}),t)})));return function(n,e){return t.apply(this,arguments)}}())},room:c}},fn=t(23),hn=t(2),bn=Y.c.div(r||(r=Object(U.a)(["\n    width: 332px;\n    margin: 50px 0;\n\n    @media screen and (min-width: 800px){\n        margin: 5% 20px;\n    }\n\n    @media screen and (min-width: 1150px){\n        width: 580px;\n        display: grid;\n        grid-template-rows: repeat(3, 0.8fr);\n        margin: 7% 20px;\n    }\n"]))),mn=Y.c.h1(i||(i=Object(U.a)(["\n    width: 100%;\n    font-size: 41px;\n    font-weight: bold;\n    color: ",";\n    margin: 30px 0;\n\n    span{\n        color: ",";\n    }\n    \n    @media screen and (min-width: 1150px){\n        font-size: 55px;\n    }\n"])),V,(function(n){return n.color})),xn=Y.c.p(o||(o=Object(U.a)(["\n    font-size: 20px;\n    line-height: 40px;\n    color: ",";\n\n    @media screen and (min-width: 1150px){\n        font-size: 18px;\n        width: 70%;\n    }\n"])),V),jn=Y.c.div(c||(c=Object(U.a)(["\n    margin-top: 39px;\n    width: 100%;\n    display: flex;\n    align-items: center;\n"]))),gn=Y.c.input(a||(a=Object(U.a)(["\n    width: 173px;\n    height: 53px;\n    text-align: center;\n    font-size: 16px;\n    font-weight: 800;\n    background: transparent;\n    border-radius: 50vw;\n    color: ",";\n    border: .2vw solid ",";\n    text-transform: uppercase;\n\n    @media screen and (min-width: 1150px){\n        height: 66px;\n    }\n"])),(function(n){return n.color}),(function(n){return n.color})),vn=Y.c.button(s||(s=Object(U.a)(["\n    cursor: pointer;\n    width: ","px;\n    height: 57px;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: ",";\n    color: white;\n    font-size: 20px;\n    border-radius: 25vw;\n    border: none;\n    text-transform: uppercase;\n    font-weight: 800;\n    transition: \n        color 0.2s,\n        background 0.2s;\n\n\n    &:hover{\n        background: white;\n        color: ",";\n        border: .15vw solid ",";\n    }\n\n    ","\n\n    ","\n"])),(function(n){return n.isBigButton?116:57}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return n.color}),(function(n){return!n.isBigButton&&Object(Y.b)(u||(u=Object(U.a)(["\n        margin-left: 20px;\n        \n        @media screen and (min-width: 800px){\n            width: 66px;\n            height: 66px;\n        }\n    "])))}),(function(n){return n.isBigButton&&Object(Y.b)(d||(d=Object(U.a)(["\n        @media screen and (min-width: 800px){\n            width: 156px;\n            height: 65px;\n        }\n    "])))})),wn=function(n){var e=n.color,t=n.firstTitlePart,r=n.secondTitlePart,i=n.description,o=n.isInput,c=n.isSmallButton,a=n.smallButtonIcon,s=n.isBigButton,u=n.bigButtonText,d=n.inputPlaceholder,l=n.onBigButtonClick,p=n.onSmallButtonClick,f=Object(T.useState)(""),h=Object(D.a)(f,2),b=h[0],m=h[1];return Object(hn.jsxs)(bn,{children:[Object(hn.jsxs)(mn,{color:e,children:[t," ",Object(hn.jsx)("span",{children:r})]}),Object(hn.jsx)(xn,{children:i}),Object(hn.jsxs)(jn,{children:[o&&Object(hn.jsx)(gn,{color:e,placeholder:d,onChange:function(n){n.preventDefault(),n.target.value.length<6&&m(n.target.value.toUpperCase())},value:b}),c&&a&&p&&Object(hn.jsx)(vn,{color:e,isBigButton:!c,onClick:function(){return p(b)},children:Object(hn.jsx)(fn.a,{icon:a})}),s&&l&&Object(hn.jsx)(vn,{color:e,isBigButton:s,onClick:function(){return l(b)},children:u})]})]})},On=Y.c.nav(l||(l=Object(U.a)(["\n    position: fixed;\n    display: flex;\n    background: ",";\n    align-items: center;\n    z-index: 100;\n    top: 0;\n    left: 0;\n    display: flex;\n    width: 100%;\n    padding: 20px;\n    box-shadow: 00 2px 10px rgba(0, 0, 0, 0.2);\n\n    @media screen and (min-width: 1000px){\n        position: relative;\n        height: 176px;\n        padding: 60px;\n        box-shadow: none;\n    }\n\n    @media screen and (min-width: 1300px){\n        background: transparent;\n    }\n"])),W),yn=Y.c.div(p||(p=Object(U.a)(["\n    margin-left: auto;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n"]))),kn=Y.c.span(f||(f=Object(U.a)(["\n    font-size: 22px;\n    font-weight: 900;\n    color: ",";\n\n    @media screen and (min-width: 1000px){\n        font-size: 35px;\n    }\n"])),Q),Cn=Y.c.input(h||(h=Object(U.a)(["\n    width: 133px;\n    height: 45px;\n    text-align: center;\n    font-size: 16px;\n    font-weight: 800;\n    background: transparent;\n    border-radius: 50vw;\n    color: ",";\n    background: ",";\n    border: none;\n\n    @media screen and (min-width: 1000px){\n      width: 290px;\n      height: 60px;\n      font-size: 20px;\n    }\n\n    &::placeholder{\n      color: white;\n      opacity: 0.8;\n      font-weight: 400;\n    }\n"])),W,V),Bn=function(){var n=Object(T.useContext)(_n).setName;return Object(hn.jsxs)(On,{children:[Object(hn.jsx)(kn,{children:"Voice Call App"}),Object(hn.jsx)(yn,{children:Object(hn.jsx)(Cn,{placeholder:"Name...",onChange:function(e){return n(e.target.value)}})})]})},Rn=t(18),zn=t(54),Fn=Y.c.div(b||(b=Object(U.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n    width: 100%;\n    height: 100%;\n\n    ",";\n"])),(function(n){var e=n.bg;return Object(Y.b)(m||(m=Object(U.a)(["\n        background: ",";\n    "])),e)})),Sn=Y.c.img(x||(x=Object(U.a)(["\n    width: 15%;\n"]))),Mn=Y.c.p(j||(j=Object(U.a)(["\n    font-size: 150%;\n    font-weight: 500;\n    color: ",";\n    margin: 20px 0;\n"])),W),Pn=function(n){var e=n.id,t=n.name,r=n.color;return Object(hn.jsxs)(Fn,{bg:r,children:[Object(hn.jsx)(Sn,{src:"".concat("https://eu.ui-avatars.com/api/?rounded=true&format=svg","&name=").concat(t)}),Object(hn.jsx)(Mn,{children:t})]},e)},Tn=t(55),En=Y.c.div(g||(g=Object(U.a)(["\n    position: fixed;\n    display: flex;\n    background: white;\n    flex-direction: row;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    z-index: -1;\n    opacity: 0;\n    background: ",";\n"])),H),An=Y.c.div(v||(v=Object(U.a)(["\n    width: 100%;\n    height: 100%;\n    display: flex;\n    flex-direction: column;\n"]))),In=Y.c.div(w||(w=Object(U.a)(["\n    display: grid;\n    position: relative;\n    height: 85%;\n    width: 100%;\n    grid-template-columns: 1fr;\n    grid-template-rows: 1fr;\n    \n\n    @media screen and (min-width: 1150px){\n        height: 88%;\n        max-width: 100%;\n\n        ","\n\n        ","\n\n        ","\n\n        ","\n\n        ","\n    }\n"])),(function(n){return 1===n.usersCount&&Object(Y.b)(O||(O=Object(U.a)(["\n            grid-template-columns: 1fr;\n            grid-template-rows: 1fr;\n        "])))}),(function(n){return 2===n.usersCount&&Object(Y.b)(y||(y=Object(U.a)(["\n            grid-template-columns: repeat(2, 1fr);\n        "])))}),(function(n){var e=n.usersCount;return e&&e>2&&e<6&&Object(Y.b)(k||(k=Object(U.a)(["\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(2, 1fr);\n        "])))}),(function(n){var e=n.usersCount;return e&&6===e&&Object(Y.b)(C||(C=Object(U.a)(["\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(2, 1fr);\n        "])))}),(function(n){var e=n.usersCount;return e&&e>6&&Object(Y.b)(B||(B=Object(U.a)(["\n            grid-template-columns: repeat(3, 1fr);\n            grid-template-rows: repeat(3, 1fr);\n        "])))})),Nn=Y.c.div(R||(R=Object(U.a)(["\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    position: relative;\n    bottom: 0;\n    width: 100%;\n    height: 15%;\n    background: ",";\n\n    button{\n        font-size: 20px;\n        border-radius: 100vw;\n        border: none;\n        color: white;\n    }\n\n    @media screen and (min-width: 1150px){\n        max-width: 100%;\n        height: 12%;\n\n        button{\n            font-size: 1.2vw;\n        }\n    }\n"])),G),Dn=Y.c.button(z||(z=Object(U.a)(["\n    width: 90px;\n    height: 80px;\n    background: ",";\n    margin: 0 10px;\n\n    @media screen and (min-width: 1150px){\n        width: 8vw;\n        height: 4vw;\n    }\n"])),K),Un=(Y.c.button(F||(F=Object(U.a)(["\n    width: 60px;\n    height: 60px;\n    background: ",";\n    margin: 0 10px;\n\n    @media screen and (min-width: 1150px){\n        width: 4vw;\n        height: 4vw;\n    }\n"])),Q),function(){var n=Object(T.useState)(!1),e=Object(D.a)(n,2),t=(e[0],e[1],Object(zn.useMediaQuery)({query:"(min-width: 800px)"})),r=Object(T.useRef)(null),i=pn(),o=i.leaveFromRoom,c=i.room;Object(T.useEffect)((function(){if(c)return Rn.a.set(r.current,{zIndex:120}),void Rn.a.to(r.current,{duration:.2,ease:"expo.inOut",opacity:1});Rn.a.to(r.current,{duration:.2,ease:"expo.inOut",opacity:0}).then((function(){Rn.a.set(r.current,{zIndex:0})}))}),[c]);return Object(hn.jsxs)(En,{ref:r,children:[Object(hn.jsxs)(An,{children:[Object(hn.jsx)(In,{usersCount:null===c||void 0===c?void 0:c.peers.length,children:t?null===c||void 0===c?void 0:c.peers.map((function(n){var e=n.id,t=n.name,r=n.color;return Object(hn.jsx)(Pn,{name:t,id:e,color:r},e)})):Object(hn.jsx)(Pn,{name:null===c||void 0===c?void 0:c.peers[0].name,id:null===c||void 0===c?void 0:c.peers[0].id,color:null===c||void 0===c?void 0:c.peers[0].color})}),Object(hn.jsx)(Nn,{children:Object(hn.jsx)(Dn,{onClick:function(){return o()},"data-tip":"Leave from room",children:Object(hn.jsx)(fn.a,{icon:_.a})})})]}),Object(hn.jsx)(Tn.a,{})]})}),Jn=Object(Y.a)(S||(S=Object(U.a)(["\n  *,\n  *::before,\n  *::after {\n    font-family: 'Montserrat', sans-serif;\n    box-sizing: border-box;\n  }\n\n  ul,li,p,h1 {\n    margin: 0;\n    padding: 0;\n  }\n\n  body{\n    margin: 0;\n    background: ",";\n  }\n\n  a,\n  a:hover,\n  a:active{\n    color: inherit;\n    text-decoration: inherit;\n  }\n\n  button {\n    cursor: pointer;\n  }\n"])),W),Ln=Y.c.div(M||(M=Object(U.a)(["\n  position: relative;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  flex-wrap: wrap;\n  flex-direction: column;\n  min-height: 100vh;\n"]))),Yn=Y.c.div(P||(P=Object(U.a)(["\n  position: relative;\n  width: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: flex-end;\n  flex-direction: column;\n  margin-top: 80px;\n\n  @media screen and (min-width: 800px){\n    margin-top: 20%;\n  }\n\n  @media screen and (min-width: 1300px){\n    flex-direction: row;\n    justify-content: center;\n    align-items: center;\n    width: 90%;\n    margin: 0;\n  }\n"]))),_n=Object(T.createContext)({name:void 0,setName:function(){},userRoom:void 0,setUserRoom:function(){}}),qn=function(){var n=Object(T.useState)(void 0),e=Object(D.a)(n,2),t=e[0],r=e[1],i=Object(T.useState)(),o=Object(D.a)(i,2),c=o[0],a=o[1],s=pn(),u=s.connectToRoom,d=(s.createRoom,function(){var n=Object(N.a)(L.a.mark((function n(){var e;return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,sn();case 2:(e=n.sent)&&a(e);case 4:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}()),l=Object(T.useRef)(null);return Object(hn.jsxs)(Ln,{children:[Object(hn.jsxs)(q.a,{children:[Object(hn.jsx)("link",{rel:"preconnect",href:"https://fonts.gstatic.com"}),Object(hn.jsx)("link",{href:"https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700;800&display=swap",rel:"stylesheet"})]}),Object(hn.jsx)(Jn,{}),Object(hn.jsxs)(_n.Provider,{value:{name:t,setName:function(n){return r(n)},userRoom:c,setUserRoom:d},children:[Object(hn.jsx)(Un,{}),Object(hn.jsx)(Bn,{}),Object(hn.jsx)(Yn,{ref:l,children:Object(hn.jsx)(wn,{color:Q,firstTitlePart:"Join by",secondTitlePart:"room id",description:"You can easy join to your room by id shared by your friend or someone else you want",isInput:!0,isSmallButton:!0,smallButtonIcon:_.b,inputPlaceholder:"Code",onSmallButtonClick:function(){var n=Object(N.a)(L.a.mark((function n(e){return L.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,u(e,t);case 2:d();case 3:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()})})]})]})},Qn=function(n){n&&n instanceof Function&&t.e(3).then(t.bind(null,98)).then((function(e){var t=e.getCLS,r=e.getFID,i=e.getFCP,o=e.getLCP,c=e.getTTFB;t(n),r(n),i(n),o(n),c(n)}))};I.a.render(Object(hn.jsx)(E.a.StrictMode,{children:Object(hn.jsx)(qn,{})}),document.getElementById("root")),Qn()}},[[95,1,2]]]);
//# sourceMappingURL=main.d1eb5cae.chunk.js.map